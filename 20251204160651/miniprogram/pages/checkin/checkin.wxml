<view class="container">
  <!-- 已签到状态 -->
  <view class="checkin-success" wx:if="{{hasCheckin}}">
    <view class="success-header">
      <image class="success-icon" src="/images/success.png"></image>
      <view class="success-title">签到成功</view>
    </view>
    
    <view class="checkin-info">
      <view class="info-item">
        <text class="info-label">姓名：</text>
        <text class="info-value">{{checkinData.name}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">部门：</text>
        <text class="info-value">{{checkinData.department}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">签到时间：</text>
        <text class="info-value">{{checkinData.checkinTime}}</text>
      </view>
    </view>

    <view class="success-actions">
      <button class="action-btn share-btn" open-type="share">分享签到</button>
      <button class="action-btn recheckin-btn" bindtap="reCheckin">重新签到</button>
    </view>
  </view>

  <!-- 未签到状态 -->
  <view class="checkin-form" wx:else>
    <view class="form-header">
      <view class="header-title">员工签到</view>
      <view class="header-desc">请填写您的信息完成签到</view>
    </view>

    <!-- 用户信息获取 -->
    <view class="user-section">
      <view class="user-info" wx:if="{{userInfo}}">
        <image class="avatar" src="{{userInfo.avatarUrl}}" mode="aspectFill"></image>
        <view class="user-details">
          <view class="nickname">{{userInfo.nickName}}</view>
          <view class="user-tip">已获取微信信息</view>
        </view>
      </view>
      
      <view class="login-prompt" wx:else bindtap="getUserProfile">
        <button class="login-btn">获取微信信息</button>
        <view class="login-tip">需要获取您的微信头像用于签到展示</view>
      </view>
    </view>

    <!-- 签到表单 -->
    <view class="form-section">
      <view class="form-group">
        <view class="form-label">
          <text class="required">*</text>
          姓名
        </view>
        <input 
          class="form-input" 
          placeholder="请输入您的姓名"
          value="{{form.name}}"
          data-field="name"
          bindinput="onInputChange"
        />
      </view>

      <view class="form-group">
        <view class="form-label">
          <text class="required">*</text>
          部门
        </view>
        <view class="form-picker" bindtap="showDepartmentActionSheet">
          <text class="picker-value {{form.department ? '' : 'placeholder'}}">
            {{form.department || '请选择部门'}}
          </text>
          <text class="picker-arrow">›</text>
        </view>
      </view>

      <view class="form-group">
        <view class="form-label">电话</view>
        <input 
          class="form-input" 
          placeholder="请输入联系电话（选填）"
          value="{{form.phone}}"
          data-field="phone"
          bindinput="onInputChange"
          type="number"
        />
      </view>
    </view>

    <!-- 提交按钮 -->
    <view class="submit-section">
      <button 
        class="submit-btn" 
        bindtap="submitCheckin"
        disabled="{{!userInfo || !form.name || !form.department}}"
      >
        确认签到
      </button>
    </view>

    <!-- 签到说明 -->
    <view class="tips-section">
      <view class="tips-title">签到说明</view>
      <view class="tips-list">
        <view class="tip-item">• 请确保填写真实姓名和部门信息</view>
        <view class="tip-item">• 签到成功后您的头像将显示在大屏幕上</view>
        <view class="tip-item">• 每人只能签到一次，请仔细核对信息</view>
        <view class="tip-item">• 签到后即可参与抽奖和游戏活动</view>
      </view>
    </view>
  </view>
</view>